'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = JUnitFormatter;
var escapeHtml = require('escape-html');

function JUnitFormatter(errorsGroupedByFile) {
  var files = Object.keys(errorsGroupedByFile);

  var xml = '<?xml version="1.0" encoding="utf-8"?>\n';

  xml = xml + '<testsuites>\n';

  files.forEach(function (file) {
    var errorsCount = errorsGroupedByFile[file].length;

    xml = xml + ('  <testsuite name="' + file + '" time="0" tests="' + errorsCount + '" errors="' + errorsCount + '">\n');

    errorsGroupedByFile[file].forEach(function (error) {
      xml = xml + ('    <testcase name="Line ' + error.locations[0].line + ', Column ' + error.locations[0].column + ': ' + error.ruleName + '">\n');
      xml = xml + ('      <failure type="error">' + escapeHtml(error.message) + '</failure>\n');
      xml = xml + '    </testcase>\n';
    });

    xml = xml + '  </testsuite>\n';
  });

  xml = xml + '</testsuites>\n';

  return xml;
}